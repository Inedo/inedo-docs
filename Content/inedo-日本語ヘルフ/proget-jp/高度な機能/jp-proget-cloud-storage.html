---
title: "クラウドにパッケージを保存する方法"
order: 6
hidden: true
---

<p>この機能は、<a href="/docs/proget-license" rel="nofollow noopener noreferrer" target="_blank" translate="no">有料版もしくは体験版の ProGet </a>でのみ使用できます。</p><p>ProGet&nbsp;はデフォルト設定の場合、パッケージファイルをディスクに保存します。しかし、クラウド（Amazon&nbsp;S3もしくはMicrosoft Azure&nbsp;Blob）に保存するように設定もできます。クラウドに保存すると以下 2 つのメリットがあります。</p><ol class="numbered-list" id="158ddf5e-357b-4ea1-8743-4d5d58f3cb7f" start="1"><li><strong>必要な時にスケールできる。&nbsp;</strong>必要なストレージのニーズを考慮する必要がなくなります。クラウドにパッケージを保存すれば、追加のストレージ容量を管理、インストール、プロビジョニングする必要がありません</li><li><strong>ディザスターリカバリがシンプルになる。&nbsp;</strong>Amazon S3とAzure&nbsp;Blobストレージは&nbsp;両方とも冗長性があり、ファイルが自動的にクラウドに保存されます。そのため大容量のパッケージファイルを考慮した、複雑なディザイスターリカバリ（災害復旧）のプランを立てる必要がありません。</li></ol><p>インターネットに接続するクラウドストレージは、ローカルディスクよりも処理速度が遅いです。しかし日常的に使うようでなれば、スピードの違いが気にならなくなります。</p><h2>フィードを設定してクラウドストレージを使う</h2><p>デフォルトの設定で、ProGetはディスクベースのパッケージ保存（ディスク上にパッケージを蓄積）を行います。</p><p>フィードのパッケージ保存を変更するには、[Manage Feed (フィードの管理)] のページに移動し、パッケージ保存のヘッダーの横にある [change (変更)] をクリックします。ダイアログが開くので、Amazon S3 か Microsoft Azure を選んでください。</p><p>選択肢に Amazon S3 や MicrosoftAzure が表示されない場合は、 [Administration (管理)] &gt; &nbsp;[Exstensions (拡張機能)] からそれぞれの拡張機能がインストールされていることをお確かめください。</p><p>パッケージ保存の種類を選ぶと、いくつかの設定オプションが表示されます。</p><h2><strong>Amazon S3&nbsp;オプション</strong></h2><div><h4><br></h4><table><thead><tr><th>[Option (オプション)]</th><th>[Description (詳細)]</th></tr></thead><tbody><tr id="10ff3bf0-8db1-407a-8dd1-574fb7cf50d3"><td>[Instance role&nbsp;(インスタンスロール)]</td><td>アクセスキーとシークレットキーをオーバーライドする（ProGetがEC2インスタンスで稼働している場合にのみ表示）</td></tr><tr id="d075db53-2978-4e49-8449-90780f63d4cb"><td>[Access Key &amp; Secret Access Key (アクセスキー・シークレットアクセスキー)]</td><td>Amazon Web Services&nbsp;のユーザー名・パスワードと同じ。Amazon&nbsp;IAM&nbsp;コンソールを使って作成</td></tr><tr><td>[Bucket Name&nbsp;(バケット名)]</td><td>S3上で設定され、パッケージ保存として使用されるストレージバケットの名前</td></tr><tr><td>[Target Path&nbsp;(ターゲットパス)]</td><td class="cell-_:uX">特定されたバケット内のパス。デフォルトは「/」</td></tr><tr id="0ee6c1c6-6c46-487c-a84f-0ff980141a40"><td>[Reduce Redundancy&nbsp;(冗長性の低下)]</td><td class="cell-_:uX">ProGet&nbsp;が、スタンダードクラスに代わって&nbsp;[Reduced Redundancy (冗長性の低下)] ストレージクラスを使ったファイルの書き込みを要求。ストレージの料金価格が安くなる傾向がある。詳細はS3のドキュメンテーションにて閲覧が可能。</td></tr><tr id="1b9279f5-cf3b-4ed4-b25f-868e7a4bd506"><td>[Make Public&nbsp;(公開する)]</td><td>アップロードされたファイルに閲覧のパブリックパーミッションが与えられる（一般的に推奨されない）</td></tr><tr><td>[Encrypted&nbsp;(暗号化)]</td><td>ProGet&nbsp;がサーバー側の暗号化の使用をパッケージに要求（一般的に推奨されない）</td></tr><tr><td>[Region Endpoint&nbsp;(リージョンエンドポイント)]</td><td class="cell-_:uX">バケットが配置されているリージョンエンドポイント（例：us-east-1）</td></tr></tbody></table></div><h2 id="11bc486c-46b2-46a9-9355-0e3c2e1cdcde"><strong>Azure Blob&nbsp;オプション</strong></h2><div class="collection-content" id="8b146d8a-fef7-4782-9ac5-085683eee46e"><table><thead><tr><th>[Option (オプション)]</th><th>[Description (詳細)]</th></tr></thead><tbody><tr id="5e6b1681-6e29-48ad-92f4-17a7c02c5cca"><td>[Connection string&nbsp;(接続文字列)]</td><td class="cell-duVT">Microsoft Azure&nbsp;接続文字列：　DefaultEndpointsProtocol=https;AccountName=account-name;AccountKey=account-key</td></tr><tr id="c70f4f62-7f5a-4bfd-bf4c-2d02060221a8"><td>[Container&nbsp;(コンテナ)]</td><td class="cell-duVT">アップロードされたファイルを受け取る &nbsp;Azure Blob コンテナ の名前</td></tr><tr id="b4f09283-d0b2-4401-ba59-198caaa409d7"><td>[Target Path (ターゲットパス)]</td><td class="cell-duVT">特定の Azure Blob 内のパス</td></tr></tbody></table></div><h2><strong>既存フィードのマイグレーション</strong></h2><p id="23eb7c40-f1c7-4604-8058-9128cba4af88">フィードのパッケージ保存を変更した場合、パッケージファイルは移動しません。新しいパッケージストレージに同じパッケージがあることを確認するには、以下の手順を実行します。</p><ol><li>キャッシュされたパッケージを削除する</li><li>ProGetサービスの停止</li><li>フィードのディスクパス（«old-disk-path»）に注意</li><li>«old-disk-path»に移動し、ディレクトリを [flatten (フラット)] にする（下の例を参照）</li><li>パッケージ保存を変更し、適切に設定する</li><li>手順3の Drop Pathを «old-disk-path» に設定する</li><li>サービスを開始する</li><li>インポート後、ステップ3の空の «old-disk-path» を削除する</li></ol><p id="b490177d-874f-4302-94e0-fb91bd120da6">注釈：この手順が使えるのは Drop Path 対応のフィードタイプのみです。</p><h2 id="63959142-258a-4336-93a1-be0416703f0e"><strong>ディレクトリをフラットにするPowerShellスクリプトの例</strong></h2><p id="3fcabdcb-63c8-4b90-8276-9f793c9b0744">シンプルなPowerShellコマンドでディレクトリをフラットにできます。</p><ol><li id="88ac10dc-87dc-4292-b50e-f63cabae4fc9">Windows Explorer上で、フラットにしたいディレクトリに移動する</li><li id="220316fd-ba58-4445-90d5-dd855bc78f2c">[File (ファイル)] → Windows PowerShellを開く</li><li id="46fe0a39-d699-4552-a15f-622ba2a1d952">Get-ChildItem -Recurse -File | ForEach-Object {Move-Item $_.FullName .}と入力</li></ol><p id="cfd87c9c-621c-4a97-9831-f57cd294b694">このコマンドは、サブフォルダ内すべてのファイルを実行されたディレクトリに移動します。他の場所にダメージを与える可能性を避けるため、必ず適切なディレクトリで実行してください。</p>
