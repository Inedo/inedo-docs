---
title: "ProGetでNuget (.Net) フィード ホストする方法"
order: 1
hidden: true
---

<p>NuGetは、無料のオープンソース.NETのライブラリを配布するためにMicrosoftが開発したパッケージ形式です。</p><p>NuGetのパッケージは <a href="http://NuGet.org">NuGet.org</a> で公開されており、Visual Studio または NuGet.exe のコマンドライン・クライアントから使用します。</p><section class="infoBox"><div class="title">NuGet&nbsp;コマンド&nbsp;ライン&nbsp;リファレンス （参照：<a href="https://docs.microsoft.com/en-us/NuGet/reference/NuGet-exe-cli-reference">NuGet CLI reference</a>）</div></section><p>ProGet を使用すると、NuGet パッケージを使用して、非公開の独自ライブラリを配布できます。&nbsp;</p><p>ライブラリを配布するには、次のように NuGet フィードを作成するだけです。</p><p>[Feeds&nbsp;(フィード)] &gt; [Create New Feed&nbsp;(新しいフィードの作成)] &gt; [Type = NuGet]</p><p>次に、フィードを新しいパッケージソースとして使用できるように Visual Studio の設定をします。</p><p>ProGet を NuGet.org のプロキシとして使用して、<a href="/docs/proget-license-detection" rel="nofollow noopener noreferrer" target="_blank" translate="no">不適切なライセンスやセキュリティの脆弱性をブロック</a>し、インターネットや NuGet.org との接続が切れてしまった場合にパッケージを<a href="/docs/proget-connector-overview" rel="nofollow noopener noreferrer" target="_blank" translate="no">キャッシュ</a>しておくこともできます。</p><p>プロキシを使用するには、コネクタを作成します。</p><p>[Feeds (フィード)] &gt; [Connectors (コネクタ)] &gt; [Create New Connector (新しいコネクタの作成)] &gt; [NuGet]</p><p>コネクタをフィードに関連付けます。</p><p id="0378fec5-9131-496a-93bd-54da20fcd2e5">[Manage Feed (フィードの管理)] &gt; [Connectors (コネクタ)]</p><h2>パッケージのインストール方法</h2><p>NuGet&nbsp;パッケージは、 NuGet CLI&nbsp;を使用してインストールします。ProGetフィードからパッケージをインストールするには、次のコマンドを使用します。</p><p>（参照：<a href="https://docs.microsoft.com/en-us/NuGet/quickstart/install-and-use-a-package-using-the-dotnet-cli">Quickstart: Install and use a package using the dotnet CLI</a>）</p><section class="html-code-block" contenteditable="false" translate="no"><code class="language-powershell" data-language="powershell">NuGet install <span class="token punctuation">{</span>package<span class="token operator">-</span>name<span class="token punctuation">}</span> <span class="token operator">-</span>Version <span class="token punctuation">{</span>package<span class="token operator">-</span>version<span class="token punctuation">}</span> <span class="token operator">-</span>Source http:<span class="token operator">/</span><span class="token operator">/</span><span class="token punctuation">{</span>proget<span class="token operator">-</span>server<span class="token punctuation">}</span><span class="token operator">/</span>NuGet<span class="token operator">/</span><span class="token punctuation">{</span>feed<span class="token operator">-</span>name<span class="token punctuation">}</span><span class="token operator">/</span></code></section><h2>NuGet&nbsp;パッケージの作成と公開</h2><p>NuGet&nbsp;のパッケージ形式については参照サイトなどに、多くの情報が公開されています。<a href="https://docs.microsoft.com/en-us/NuGet/guides/create-net-standard-packages-vs2017">Visual Studio で作成する</a>、または&nbsp;NuGet.exe&nbsp;を使用するなど、さまざまな方法でパッケージが作成できます。</p><p>参照：<a href="https://docs.microsoft.com/en-us/NuGet/reference/nuspec">&nbsp;.nuspec reference</a></p><p>参照：<a href="https://docs.microsoft.com/en-us/NuGet/quickstart/create-and-publish-a-package-using-visual-studio?tabs=netcore-cli">Quickstart: Create and publish a NuGet package using Visual Studio (.NET Standard, Windows only)</a></p><figure class="block-color-gray_background callout" id="f3560bf9-57c7-4f88-8260-3767d071fd6c" style="box-sizing: border-box; -webkit-print-color-adjust: exact; margin: 1.25em 0px; break-inside: avoid; border-radius: 3px; padding: 1rem; background: rgb(235, 236, 237); color: rgb(55, 53, 47); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, &quot;Apple Color Emoji&quot;, Arial, sans-serif, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: medium; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: flex;"><div style="box-sizing: border-box; -webkit-print-color-adjust: exact; font-size: 1.5em;"><span class="icon" style="box-sizing: border-box; -webkit-print-color-adjust: exact; display: inline-block; max-width: 1.2em; max-height: 1.2em; text-decoration: none; vertical-align: text-bottom; margin-right: 0.5em;">💡</span></div><div style="box-sizing: border-box; -webkit-print-color-adjust: exact; width: 831.453px;"><a href="/docs/buildmaster/development-platforms/buildmaster-platforms-dotnet/buildmaster-platforms-dot-net-nuget">BuildMaster の NuGet パッケージのドキュメント</a>では、継続的インテグレーションと継続的デリバリー（CI / CD）の原則を適用し、アプリケーションと一緒に作成したパッケージを迅速にテストして配布する方法を学べます。</div></figure><p>作成したパケージを、ProGet で公開するには次の4つの方法があります。</p><ul><li>ディスクからのアップロード：事前にパッケージ化された NuGet パッケージ（.nupkg）をディスクからアップロードします。</li><li>NuGet コマンドライン・ユーティリティでプッシュする：NuGet.exe&nbsp;コマンドラインを使用してパッケージをローカルフィードに追加します。</li><li>別のフィードから pull（プル）する：別のNuGetフィード（NuGet.orgなど）からパッケージを pull（プル）します。</li></ul><section class="warningBox"><p>注：このフィードのURLについては、現時点では NuGet v2 の URL をご記入いただくことが必要です。(例 https://NuGet.org/api/v2)</p></section><ul><li>パッケージを一括でインポート/ [File Copy (ファイルのコピー)]：複数の既存パッケージを1回でインポートします</li></ul><p>パッケージをフィードに追加する方法の詳細については、NuGet フィードの [Add Package (パッケージの追加)] ボタンをクリックしてご覧ください。</p><h2>NuGet&nbsp;のAPIキー</h2><p>NuGet クライアントツール（NuGet.exe や NuGet&nbsp;パッケージ&nbsp;エクスプローラーなど）には、パッケージ公開の認証方法として「NuGet&nbsp;APIキー」を使用するオプションが備わっています。これは、コミュニティが運営の&nbsp;NuGet ギャラリーのサイトにおいて、誰でも自身のパッケージを公開できるようにするために、非常に重要なオプションです。しかし、企業組織内では「個々のパッケージの所有権」の概念が、しっかりと意識されているかと言うとそうではありません。</p><p>ProGet&nbsp;をご使用になる場合、（ユーザーまたはグループの）プリンシパルは、フィードにパッケージ公開する権限を持っているか、持っていないかのどちらかです。ProGet&nbsp;管理者は、API&nbsp;キーなどによる管理方法ではなく、LDAP&nbsp;とグループを介してアクセスや利用を、簡単に制御できます。ただし、ProGet&nbsp;にプッシュする際に、NuGet&nbsp;の API キーをご使用になりたい場合には次の2つの方法があります。</p><ul><li>APIキーとして「username：password」を使用する：ProGet をご使用中のユーザーは、APIキーをusername：passwordの形式で使用するモードでの認証が可能です。たとえば、NuGet.exeの ApiKey Admin:Admin&nbsp;オプションを使用して、既定のProGet管理者アカウントでパッケージを [Feed (フィード)] にプッシュすることができます。</li><li>ProGet&nbsp;API&nbsp;キーの作成：[Feed Access (フィードアクセス)]&nbsp;を使用して、ProGet&nbsp;で API キー（管理者・APIキー・アクセスログ）を作成します。このキーは、特定のアクセス権限を持つユーザーに限定することで、さらに制限ができます。</li></ul><h3>レガシー NuGet のAPIキーを引き継ぐ</h3><p>ProGet 5.0 以前には、 NuGet の (Quirks) フィードは [Manage Feed (フィードの管理)] のページで、APIキーの定義をサポートしていました。</p><p>ただし、ProGet 5.0 以前のキーは、ProGet 5.3 へのアップグレード時に削除されます。（参照：<a href="/docs/proget/feeds/nuget#legacy">Legacy (Quirks) NuGet Feeds</a>）</p><p>レガシー NuGet API キーは、ProGet API キーとは多少は異なる動作をします。認証済みのユーザーのほかに、フィードに定義されているレガシーキーの確認も実施します。そして同じキーがレガシーキーと ProGet キーの両方で定義されている場合には、ProGetキーの方を優先します。</p><h2>シンボルとソースパッケージ</h2><p>ProGet の NuGet フィードは Visual Studio や WinDbg などのデバッガーとも、互換性のあるシンボルサーバやソースサーバを構成します。詳細については、「<a href="/docs/proget-symbol-and-source-server" rel="nofollow noopener noreferrer" target="_blank" translate="no">ProGet のシンボルとソースサーバ</a>」をご参照ください。</p><h2>NuGet APIの使用について</h2><p>ProGetは、サードパーティの API、NuGet ODATA プロトコルを実装しています。</p><section class="errorBox"><div style="box-sizing: border-box; -webkit-print-color-adjust: exact; width: 827.203px;">NuGet.orgは、2020年3月9日にV2 ODATAクエリを非推奨にします。これがProGetに与える影響については、<a href="https://inedo.com/support/kb/1800/problems-with-my-NuGet-org-connectors">ナレッジベース</a>（リンク先英語）を参照してください。</div></section><p>また役立つと思われる一般的なクエリも、いくつかご紹介します。</p><h3>JSON形式でフィードにある すべてのパッケージを一覧表示する</h3><p>https://«proget-server»/NuGet/«feed-name»/Packages?$format=json</p><h3>ProGet フィードからパッケージを手動でダウンロードする</h3><p>https://«proget-server»/api/v2/package/«feed-name»/«packageName»/«versionNumber[optional]»</p><h3>ODATAのパッケージ クエリ</h3><p>https://«proget-server»/NuGet/{feed-name}/Packages?$filter=Id%20eq%20'«package-name»'</p><h3>最新バージョンのパッケージを取得する</h3><p>https://«proget-server»/NuGet/{feed-name}/Packages()?$filter=Id%20eq%20%27«package-name»%27%20and%20IsAbsoluteLatestVersion&amp;$top=1</p><h3>NuGet V3 API</h3><p>NuGet.orgとNuGet クライアント ツールはいずれも、ODATA（v2）とJSON-LD（v3）の2種のAPIプロトコルをサポートしています。ProGet 5.3 以降はどちらもサポートしていますが、以前のバージョンでは、ODATA（v2）のみをサポートしていました。</p><p>NuGet フィードで JSON-LD（v3）が有効になっている場合、v3 のAPI URLがNuGet フィードページに表示され、ODATA（v2）とJSON-LD（v3）を有効にすると、どちらもご使用いただけます。</p><p>ODATA（v2）API は、</p><p>«proget-base»/NuGet/«feed-name»</p><p>JSON-LD（v3）APIは、</p><p>«proget-base»/NuGet/«feed-name»/v3/index.json</p><p>構成には関係なく、NuGet.org へのコネクタとして、必ず<a href="https://api.NuGet.org/v3/index.json">https://api.NuGet.org/v3/index.json</a>にある、JSON-LD（v3）のエンドポイントを使用することにご留意ください。（参照：<a href="https://api.NuGet.org/v3/index.json">https://api.NuGet.org/v3/index.json</a>）http://NuGet.org/api/v2#v2のように、NuGet.orgのURLの末尾にオーバーライドするトークン（ #v2 ）を追加して、ODATA（v2）プロトコルを強制することができます。</p><h2>レガシーNuGet（Quirks）フィードからの移行</h2><p>ProGet 5.0 より前に作成された NuGet フィードは、レガシー（Quirks）NuGetフィードと見なされます。Quirks フィードのタイプは、NuGet.org が過去に採用していた、あまり制度化されていない頃の、セマンティック バージョニング ルールに基づいています。新しい NuGet フィードがプレリリース バージョンの文字列にセマンティック バージョニング 2.0 ルール（以下SemVer2) を適用したため、ProGet 5.0 には、より洗練されたバージョニング スキームを導入しました。ただし、SemVer2 の仕様に適合しないバージョンも、SemVer2 フィードには表示されています。</p><p>レガシー（Quirks）NuGet フィードを移行するには、フィード管理ページの [migrate (移行)] リンクをクリックします。ProGet では、いくつかの移行オプションに、確認ダイアログのポップアップ表示をしています。移行を実行すると、ProGet は次の手順へと進みます。</p><ul><li>フィードを無効状態に設定</li><li>新しいメタデータ（データベース）エントリをフィードに追加</li><li>フィードの古い（quirks）メタデータを削除</li><li>フィードを再アクティブ化</li></ul><p id="5f8794ef-449c-454c-aa2b-03627988dc62">移行はすべてデータベースでの処理で行うため、パッケージを実際に操作する必要はまったくありません。デフォルトでは、移行は単一のデータベース トランザクションとして実行されるため、万が一障害が発生した場合にはロールバックする可能性があります。フィードに非常に多くのパッケージ（10,000以上）がある場合は、移行を実行する前に ProGet SQL データベースのバックアップを実行したうえで、[migrate feed (フィードの移行)] ダイアログの適切なチェックボックスをオフにして、単一トランザクション モードは無効にしておくことを強くおすすめします。</p><p>レガシー（Quirks）の NuGet フィードは ProGet 5.3 で削除され、フィードをすべて移行するか削除しない限りは、アップグレードをブロックします。</p><h2>NuGet フィードでインデックスを再作成</h2><p>ProGet では、NuGet フィードのインデックス再作成を、はじめから SemVer2 フィード（つまりレガシーではない）のシンボルサーバーとソースサーバーのインデックスを再作成するように設計しています。ProGet v5.0 以降では、さらに、次の追加アクションを実行するように修正しました。詳細は、「<a href="/docs/proget-symbol-and-source-server" rel="nofollow noopener noreferrer" target="_blank" translate="no">ProGet のシンボルとソースサーバ</a>」をご覧ください。</p><ul><li>プレリリース バージョン管理とメタデータのビルドに関連する不整合を修正しました。</li><li>パッケージストアに残っていないローカルパッケージ、またはキャッシュされたパッケージは、データベースから削除します。</li><li>パッケージでデータベースインデックス付きの.nuspec データを修正しました。</li></ul><p>NuGet フィードでインデックスの再作成を実行するには、NuGet、Chocolatey、または PowerShell フィードの</p><p>[Manage Feed (フィードの管理)] ページにアクセスし、[Symbol Server feed property (シンボルサーバーフィードのプロパティ)] セクションで [re-index (インデックスの再作成)] を選択してください。</p><h2>再パッケージ化</h2><p>再パッケージ化は、パッケージの内容を変更せずにパッケージのバージョンを変更するプロセスであり、<a href="/docs/proget-repackaging" rel="nofollow noopener noreferrer" target="_blank" translate="no">プレリリース パッケージ</a>を安定版の方に変更するなどのユースケースのご提供が可能です。</p><p>ProGet は、NuGet の再パッケージ化をサポートしています。CI/CD システムで&nbsp;RepackagingAPI&nbsp;を使用して完了させる方法の例は、パブリック BuildMaster インスタンスのサンプルアプリケーションで閲覧が可能です。（参照：<a href="/docs/proget/packages/repackaging">Repackaging API</a>）</p><h2>パッケージの削除とリスト解除&nbsp;</h2><p>フィードから NuGet パッケージを削除（完全に削除）またはリストから外す（検索結果では、ほぼ非表示にする）には、パッケージページに移動し、対象パッケージを [Delete Package (パッケージの削除)] または [Unlist Package (パッケージをリストから外す)] ボタンをクリックして実行します。削除やリスト解除を実行するには、Feeds_DeletePackage&nbsp;または Feeds_UnlistPackageそれぞれの属性でのパーミションが必要です。</p><p>プログラムでフィードからパッケージを削除するには、NuGet CLI の&nbsp;delete コマンドを使用するか、HTTP 経由で DELETE リクエストを作成します。（参照：<a href="https://docs.microsoft.com/en-us/NuGet/reference/cli-reference/cli-ref-delete">delete command (NuGet CLI)</a>）</p><p>DELETE http://{proget-server}/NuGet/{feed-name}/package/{ID}/{VERSION}`</p><p>NuGet CLI の delete コマンド操作は、パッケージをリスト解除するだけのNuGet.org の DELETE コマンドとは異なることにご注意ください。（参照：<a href="https://docs.microsoft.com/en-us/NuGet/api/package-publish-resource#delete-a-package">Delete a package</a>）</p><p>プログラムでパッケージをリストから解除（または再リスト）するには、ネイティブAPIでNuGetPackagesV2_SetListed メソッドを使用します。（参照：<a href="/docs/proget/api/http-requests">Native API Reference</a>）</p><p><br></p>
